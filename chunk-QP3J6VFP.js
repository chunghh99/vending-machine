import{a as Q}from"./chunk-B5M6CCOG.js";import"./chunk-BKZFVQBW.js";import{a as _}from"./chunk-KDM4M3GL.js";import{a as W}from"./chunk-OPDTKCI5.js";import{a as q}from"./chunk-HNKJNLW6.js";import"./chunk-4C57YJA5.js";import{c as U,d as g,e as j,f as G,k as M,l as R,m as H,n as L,o as O,q as z,r as J,s as K}from"./chunk-2PP4UNEY.js";import{b as B,d as k}from"./chunk-TN45MXFT.js";import{Cb as T,Cc as w,Ea as b,Fb as E,Gb as p,Ma as F,Qa as l,Qb as m,Ra as u,Sb as A,Sc as V,Yb as D,kb as s,la as I,mb as c,na as P,ob as f,sb as N,va as x,wa as y,wb as r,xb as o,yb as v}from"./chunk-ZFL4TBTD.js";import"./chunk-4L4RMVSS.js";var X=(()=>{let a=class a{constructor(n){this.el=n}onInputChange(n){let i=this.el.nativeElement.value.replace(/[^\d,]/g,"");i=this.removeExtraCommas(i),this.el.nativeElement.value=this.formatCurrency(i)}formatCurrency(n){return n.replace(/\B(?=(\d{3})+(?!\d))/g,",")}removeExtraCommas(n){return n.replace(/,/g,"")}};a.\u0275fac=function(t){return new(t||a)(u(b))},a.\u0275dir=P({type:a,selectors:[["","appNumericCurrency",""]],hostBindings:function(t,i){t&1&&E("ngModelChange",function(h){return i.onInputChange(h)})},standalone:!0});let e=a;return e})();function C(e){if(typeof e=="number")return e;let a=e.replace(/,/g,"");return parseFloat(a)}function ee(e,a){e&1&&(r(0,"h4"),m(1,"Th\xEAm m\u1EDBi h\xE0ng h\xF3a"),o())}function te(e,a){e&1&&(r(0,"h4"),m(1,"C\u1EADp nh\u1EADt h\xE0ng h\xF3a"),o())}function ie(e,a){e&1&&(r(0,"div",24),m(1," M\xE3 h\xE0ng h\xF3a kh\xF4ng \u0111\u01B0\u1EE3c \u0111\u1EC3 tr\u1ED1ng. "),o())}function ne(e,a){if(e&1&&(r(0,"div"),s(1,ie,2,0,"div",23),o()),e&2){let d=p();l(),c("ngIf",d.showError("productCode","required"))}}function re(e,a){e&1&&(r(0,"div",24),m(1," T\xEAn h\xE0ng h\xF3a kh\xF4ng \u0111\u01B0\u1EE3c \u0111\u1EC3 tr\u1ED1ng. "),o())}function oe(e,a){if(e&1&&(r(0,"div"),s(1,re,2,0,"div",23),o()),e&2){let d=p();l(),c("ngIf",d.showError("productName","required"))}}function ae(e,a){e&1&&(r(0,"div",24),m(1," Lo\u1EA1i slot kh\xF4ng \u0111\u01B0\u1EE3c \u0111\u1EC3 tr\u1ED1ng. "),o())}function le(e,a){if(e&1&&(r(0,"div"),s(1,ae,2,0,"div",23),o()),e&2){let d=p();l(),c("ngIf",d.showError("slotType","required"))}}function me(e,a){if(e&1&&m(0),e&2){let d=p();A(" ",d.formSave.controls.imageName.value," ")}}function ce(e,a){e&1&&m(0," Ch\u1ECDn file ")}function de(e,a){e&1&&(r(0,"div",24),m(1," H\xECnh \u1EA3nh kh\xF4ng \u0111\u01B0\u1EE3c \u0111\u1EC3 tr\u1ED1ng. "),o())}function se(e,a){if(e&1&&(r(0,"div"),s(1,de,2,0,"div",23),o()),e&2){let d=p();l(),c("ngIf",d.showError("imageName","required"))}}function ue(e,a){e&1&&(r(0,"div",24),m(1," Gi\xE1 hi\u1EC3n th\u1ECB kh\xF4ng \u0111\u01B0\u1EE3c \u0111\u1EC3 tr\u1ED1ng. "),o())}function pe(e,a){if(e&1&&(r(0,"div"),s(1,ue,2,0,"div",23),o()),e&2){let d=p();l(),c("ngIf",d.showError("displayPrice","required"))}}function ve(e,a){e&1&&(r(0,"div",24),m(1," Gi\xE1 nh\u1EADp kh\xF4ng \u0111\u01B0\u1EE3c \u0111\u1EC3 tr\u1ED1ng. "),o())}function he(e,a){if(e&1&&(r(0,"div"),s(1,ve,2,0,"div",23),o()),e&2){let d=p();l(),c("ngIf",d.showError("inputPrice","required"))}}function fe(e,a){if(e&1){let d=T();r(0,"div",25)(1,"button",26),E("click",function(){x(d);let t=p();return y(t.onCreate())}),v(2,"i",27),m(3," Th\xEAm m\u1EDBi "),o()()}}function ge(e,a){if(e&1){let d=T();r(0,"div",25)(1,"button",26),E("click",function(){x(d);let t=p();return y(t.onUpdate())}),v(2,"i",28),m(3," C\u1EADp nh\u1EADt "),o()()}}var De=(()=>{let a=class a{constructor(n,t,i,S,h,Y,Z){this.fb=n,this.route=t,this.router=i,this.sanitizer=S,this.spinnerService=h,this.itemsService=Y,this.toastr=Z,this.action="CREATE"}ngOnInit(){this.formSave=this.fb.group({productCode:["",[g.required]],productName:["",[g.required]],slotType:["",[g.required]],imageName:["",[g.required]],image:[""],displayPrice:["",[g.required]],inputPrice:["",[g.required]]}),this.route.params.subscribe(n=>{this.param=n.id,console.log(n,this.param),this.param&&this.getItemDetail(this.param)}),this.router.url.includes("/update/")&&(this.action="UPDATE")}getItemDetail(n){this.spinnerService.show(),this.itemsService.getItemById(n).subscribe(t=>{console.log("res getItemById",t),this.spinnerService.hide(),t&&t.status&&t.status.code===_.STATUS.SUCCESS&&t.data&&(this.formSave.patchValue({productCode:t.data.code,productName:t.data.name,displayPrice:t.data.basePrice,inputPrice:t.data.importedPrice,imageName:this.getImageName(t.data.image),slotType:t.data.type}),this.previewImages=t.data.image,console.log("formSave.patchValue",this.formSave.value))},t=>{this.spinnerService.hide()})}getImageName(n){if(n){let t=n.split("/");return t.length>0?t.pop():null}return""}onUpdate(){if(console.log(this.formSave.value),this.formSave.invalid){this.formSave.markAllAsTouched(),this.formSave.markAsDirty(),this.formSave.updateValueAndValidity();return}let n=this.formSave.value,t={name:n.productName,basePrice:C(n.displayPrice),importedPrice:C(n.inputPrice),code:n.productCode,type:n.slotType};this.previewImages.includes("http")||(t.imageBase64=this.previewImages),this.spinnerService.show(),this.itemsService.updateItem(t,this.param).subscribe(i=>{this.spinnerService.hide(),console.log("response update => ",i),i&&i.status&&i.status.code===_.STATUS.SUCCESS?this.toastr.success("C\u1EADp nh\u1EADt h\xE0ng h\xF3a th\xE0nh c\xF4ng!","Th\xF4ng b\xE1o"):this.toastr.error("C\u1EADp nh\u1EADt h\xE0ng h\xF3a th\u1EA5t b\u1EA1i!","Th\xF4ng b\xE1o")},i=>{this.spinnerService.hide()})}onCreate(){if(this.formSave.invalid){this.formSave.markAllAsTouched(),this.formSave.markAsDirty(),this.formSave.updateValueAndValidity();return}console.log(this.formSave.value);let n=this.formSave.value,t={name:n.productName,basePrice:C(n.displayPrice),importedPrice:C(n.inputPrice),code:n.productCode,type:n.slotType};this.previewImages.includes("http")||(t.imageBase64=this.previewImages),this.spinnerService.show(),this.itemsService.createItem(t).subscribe(i=>{this.spinnerService.hide(),console.log("response update => ",i),i&&i.status&&i.status.code===_.STATUS.SUCCESS?this.toastr.success("Th\xEAm m\u1EDBi h\xE0ng h\xF3a th\xE0nh c\xF4ng!","Th\xF4ng b\xE1o"):this.toastr.error("Th\xEAm m\u1EDBi h\xE0ng h\xF3a th\u1EA5t b\u1EA1i!","Th\xF4ng b\xE1o")},i=>{this.spinnerService.hide()})}onFileChange(n){let t=n.target.files;if(console.log("selectedFiles",t),t){let i=t.item(0);if(i){this.previewImages="";let S=new FileReader;S.onload=h=>{console.log(h.target.result),this.previewImages=h.target.result},S.readAsDataURL(i),this.formSave.patchValue({imageName:i.name})}}}validField(n){let t=this.formSave.get(n);return t.invalid&&(t.dirty||t.touched)}showError(n,t){let i=this.formSave.get(n);return i.hasError(t)&&i.touched}};a.\u0275fac=function(t){return new(t||a)(u(z),u(B),u(k),u(V),u(q),u(Q),u(W))},a.\u0275cmp=I({type:a,selectors:[["app-save-product"]],standalone:!0,features:[D],decls:69,vars:26,consts:[[4,"ngIf"],[1,"from",3,"formGroup"],[1,"row","mt-5"],[1,"col-md-2","col-sm-4","col-xs-12"],[1,"form-label","col-form-label"],[1,"required"],[1,"col-md-4","col-sm-8","col-xs-12"],["formControlName","productCode",1,"form-control"],["formControlName","productName",1,"form-control"],[1,"row","row","mt-3"],["aria-label","","formControlName","slotType",1,"form-select","custom-select"],["value","SINGLE",1,"custom-option"],["value","DOUBLE",1,"custom-option"],[1,"col-md-2","col-sm-4","col-xs-6"],[1,"preview",3,"src"],[1,"custom-file"],["type","file","accept","image/jpeg","formControlName","image","id","image",1,"form-control","input-file-custom",3,"change","multiple"],["for","image",1,"custom-file-label","cursor-pointer","text-center"],[1,"fa","fa-file-image-o","float-start",2,"margin-top","2%","height","auto"],["formControlName","displayPrice","appNumericCurrency","",1,"form-control"],["formControlName","inputPrice","appNumericCurrency","",1,"form-control"],[1,"row"],["class","col-12 text-center mt-3",4,"ngIf"],["class","error-message",4,"ngIf"],[1,"error-message"],[1,"col-12","text-center","mt-3"],["type","button",1,"btn","btn-primary-custom","ml-20",3,"click"],[1,"fa","fa-plus"],[1,"fa","fa-save"]],template:function(t,i){t&1&&(r(0,"div"),s(1,ee,2,0,"h4",0)(2,te,2,0,"h4",0),r(3,"div",1)(4,"div",2)(5,"div",3)(6,"label",4),m(7," M\xE3 h\xE0ng h\xF3a"),r(8,"span",5),m(9,"*"),o()()(),r(10,"div",6),v(11,"input",7),s(12,ne,2,1,"div",0),o(),r(13,"div",3)(14,"label",4),m(15," T\xEAn h\xE0ng h\xF3a"),r(16,"span",5),m(17,"*"),o()()(),r(18,"div",6),v(19,"input",8),s(20,oe,2,1,"div",0),o()(),r(21,"div",9)(22,"div",3)(23,"label",4),m(24," Lo\u1EA1i slot"),r(25,"span",5),m(26,"*"),o()()(),r(27,"div",6)(28,"select",10)(29,"option",11),m(30,"Slot \u0111\u01A1n"),o(),r(31,"option",12),m(32,"Slot \u0111\xF4i"),o()(),s(33,le,2,1,"div",0),o(),r(34,"div",3)(35,"label",4),m(36," H\xECnh \u1EA3nh"),r(37,"span",5),m(38,"*"),o()()(),r(39,"div",13),v(40,"img",14),o(),r(41,"div",13)(42,"div",15)(43,"input",16),E("change",function(h){return i.onFileChange(h)}),o(),r(44,"label",17),v(45,"i",18),s(46,me,1,1)(47,ce,1,0),o(),s(48,se,2,1,"div",0),o()()(),r(49,"div",9)(50,"div",3)(51,"label",4),m(52," Gi\xE1 hi\u1EC3n th\u1ECB(\u0110\u1ED3ng)"),r(53,"span",5),m(54,"*"),o()()(),r(55,"div",6),v(56,"input",19),s(57,pe,2,1,"div",0),o(),r(58,"div",3)(59,"label",4),m(60," Gi\xE1 nh\u1EADp(\u0110\u1ED3ng)"),r(61,"span",5),m(62,"*"),o()()(),r(63,"div",6),v(64,"input",20),s(65,he,2,1,"div",0),o()(),r(66,"div",21),s(67,fe,4,0,"div",22)(68,ge,4,0,"div",22),o()()()),t&2&&(l(),c("ngIf",i.action==="CREATE"),l(),c("ngIf",i.action==="UPDATE"),l(),c("formGroup",i.formSave),l(8),f("is-invalid",i.validField("productCode")),l(),c("ngIf",i.validField("productCode")),l(7),f("is-invalid",i.validField("productName")),l(),c("ngIf",i.validField("productName")),l(8),f("is-invalid",i.validField("slotType")),l(5),c("ngIf",i.validField("slotType")),l(7),c("src",i.previewImages,F),l(3),c("multiple",!1),l(),f("is-invalid",i.validField("imageName")),l(2),N(46,i.formSave.controls.imageName.value?46:47),l(2),c("ngIf",i.validField("imageName")),l(8),f("is-invalid",i.validField("displayPrice")),l(),c("ngIf",i.validField("displayPrice")),l(7),f("is-invalid",i.validField("inputPrice")),l(),c("ngIf",i.validField("inputPrice")),l(2),c("ngIf",i.action==="CREATE"),l(),c("ngIf",i.action==="UPDATE"))},dependencies:[J,L,O,U,H,j,G,K,M,R,w,X]});let e=a;return e})();export{De as SaveProductComponent};
